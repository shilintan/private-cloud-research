# LVM与ZFS：您应该为Linux使用哪种卷管理器？

2022年9月26日 上午11:20 • [电脑](https://www.duotin.com/en)

Linux 生态系统提供了各种开源文件系统软件，使您可以轻松安排文件系统设置，让您控制数据。卷管理对于磁盘空间的管理至关重要，它使用存储虚拟化来分区和组织数据，以便您可以有效地使用它。

LVM 和 ZFS 是 Linux 上卷管理的两个主要选项，但它们在范围和性能上存在显着差异。

在本文中，我们将分享 LVM 和 ZFS 之间的主要区别，以及哪个选项最适合您的卷管理需求。[![LVM与ZFS：您应该为Linux使用哪种卷管理器？](https://www.duotin.com/wp-content/uploads/2022/09/2022092603202425-1024x683.jpg)](https://www.duotin.com/wp-content/uploads/2022/09/2022092603202425-1024x683.jpg)

## LVM 与 ZFS：全面比较

LVM 是Linux 领先的卷管理器之一，它与用于动态调整系统磁盘空间大小的文件系统并驾齐驱。ZFS 是文件系统和卷管理器的结合。这是一个主要区别，因为 ZFS 全面地组织和管理您的数据。LVM 不是文件系统，而是在与文件系统不同的层中运行以执行磁盘管理。

## LVM 与 ZFS：并列比较

|                  | **LVM**                                                    | **ZFS**                                                      |
| ---------------- | ---------------------------------------------------------- | ------------------------------------------------------------ |
| 这是什么         | 逻辑卷管理器                                               | 日志文件系统和卷管理器                                       |
| 主要用途         | Linux 内核的磁盘空间管理                                   | Linux 文件系统                                               |
| 写在             | C                                                          | C                                                            |
| 受孕             | 1998                                                       | 2001年                                                       |
| 最大卷大小       | 每个逻辑卷 (LV) 165,536 个物理盘区 (PE)                    | 256 万亿 yobibytes（2 128 字节）                             |
| 最大文件大小     | 16 exbibytes（2 64 字节）                                  | 16 exbibytes（2 64 字节）                                    |
| 最大文件名大小   | 每个逻辑卷 64 个字符，总共 126 个字符（卷组名 + 逻辑卷名） | 255 个 ASCII 字符                                            |
| 属性             | 是的                                                       | 是的                                                         |
| 写时复制 (CoW)   | 是的                                                       | 是的                                                         |
| 有影响力的开发者 | Heinz Mauelshagen，Sistina Software，IBM，甲骨文           | AT&T、Sun Microsystems、甲骨文、OpenZFS                      |
| 开源             | 是的                                                       | 是（OpenZFS）                                                |
| 技术影响         | Linux、Ubuntu、RedHat、Fedora                              | OpenSolaris、illumos 发行版、OpenIndiana、FreeBSD、Mac OS X 服务器、NetBSD、Linux |

## LVM 与 ZFS：10 个需要知道的事实

1. 逻辑卷管理器与文件系统一起运行，以提供简单、灵活的磁盘空间管理。

- LVM 不是文件系统。

1. Sun Microsystems 最初开发 Zettabyte 文件系统 (ZFS) 作为 Solaris OS 的一部分。

1. LVM 有助于将多个单独的硬盘驱动器或磁盘分区聚合到单个卷组 (VG) 中。然后，您可以将卷组作为单个、大卷或较小的逻辑卷 (LV) 进行管理。

1. ZFS 和 LVM 都使用写时复制 (COW)，这是一种资源管理技术，在修改或更新源数据时保留原始数据的副本。

1. 一个逻辑卷可以包含整个文件系统，如 ext3 或 ext4。

1. 您可以动态调整 ext3 和 ext4 文件系统的大小，使它们成为 LVM 的理想选择。

1. 您可以扩展或减少逻辑卷中的磁盘空间量。

1. ZFS 创建 zpool，将来自多个物理磁盘的数据汇集在一起，作为统一存储池进行管理。

1. ZFS 将其存储池组织并呈现为虚拟设备 (vdev)。

## 什么是逻辑卷管理器？

逻辑卷管理器，也称为 LVM，是 Linux 内核的卷管理工具。Linux 用户将它与文件系统一起运行以执行关键任务，例如磁盘分配、镜像、条带化和调整逻辑卷的大小。

LVM 的优势在于它能够动态调整大小，因此您可以在文件系统运行时为磁盘分配更多空间。LVM 自 1990 年代后期就已经可用，并且与大多数现代 Linux 发行版兼容。

### LVM 是如何工作的？

LVM 采用一个或多个硬盘驱动器并将它们分配给物理卷 (PV)，然后将物理卷 (/boot 除外) 组合成卷组 (VG) 和单独的逻辑卷 (LV)。

您可以使用以下命令创建这三个元素：

1. 对于物理组使用：pvcreate
2. 对于卷组，请使用：vgcreate
3. 对于逻辑卷使用：lvcreate

逻辑卷有助于动态调整卷大小。LVM 可以通过添加或更换磁盘来管理硬盘场，而不会中断系统。它还可以在个人计算级别有效地调整文件系统的大小。

LVM 还通过执行逻辑卷的定期快照来保护数据完整性，并通过使用单个密码加密多个物理分区来确保安全性。LVM 还可以包含 RAID 功能并支持 RAID 1、5 和 6。

[![硬盘](https://www.duotin.com/wp-content/uploads/2022/09/2022092603203181.jpg)](https://www.duotin.com/wp-content/uploads/2022/09/2022092603203181.jpg)*管理卷对于有效组织和使用数据至关重要，LVM 和 ZFS 是很好的选择。*

### LVM 的历史

Heinz Mauelshagen 是 Sistina Software（现在在 RedHat 工作）的一名软件工程师，他于 1998 年编写了原始 LVM 代码。他是主要的 LVM1 架构师/开发人员，后来成为 LVM2 开发的团队领导设备映射器。LVM 代码基于 Hewlett-Packard Unix OS 卷管理器。

### LVM 功能

LVM 具有用于大规模管理 PV、VG 和 LV 的基本和高级功能。以下是一些显着的特点：

- 您可以在线调整卷组和逻辑卷的大小。
- 通过添加或弹出物理卷来调整 VG 的大小。
- 通过链接或缩短其组成范围来调整 LV 的大小。
- LVM 还允许您在 PV 之间移动 LV。
- LVM 使用写时复制，并且可以创建只读或读/写快照来保护您的数据。
- 您可以创建具有 RAID 功能和条带化部分或整个 LV 的 LV。
- LVM 的高级用户可以创建混合卷，利用闪存驱动器和其他快速存储的容量为硬盘驱动器创建缓存。
- LVM 和 LVM2 有一个设备映射器。这个框架是 Linux 内核的一部分，将物理块设备映射到虚拟块设备上。

## 什么是 ZFS？

ZFS 是一种现代 Linux 文件系统，它具有包含卷管理器的额外好处。它目前归 Orcale, Inc. 所有，但开源版本 OpenZFS 在 Linux 用户中很受欢迎。

ZFS 可以汇集和管理来自多个物理存储设备的数据，包括硬盘驱动器和内存卡。它将数据聚合到 zpool 中，然后将其组织起来以供操作系统有效使用。与任何其他文件系统一样，ZFS 使用最先进的数据保护来管理存储的数据和文件，以保持数据完整性。

### ZFS 的历史

Sun Microsystems 开发了 ZFS 作为其 Solaris OS 的文件系统。2005 年，Sun Microsystems 开源了包括 ZFS 在内的 Solaris OS。一个开发者社区将 ZFS 移植到 Linux，并继续作为 OpenZFS。与此同时，Sun Microsystems 将 Solaris 出售给 Oracle，后者继续开发自己的 ZFS 版本作为商业产品。

### ZFS 的特点

ZFS 是最先进的 Linux 文件系统之一。添加集成的卷管理器使其更加强大和自适应。它被广泛用作服务器和其他企业应用程序的文件系统。

其主要特点包括：

- ZFS 具有可供 Linux 用户使用的最大文件系统容量之一。它几乎可以无限扩展，同时提供高标准的数据完整性和保护。它的 16 exbibytes（2 64字节）文件大小是可用的最大文件大小。

- ZFS 不寻常，因为它将卷管理与文件系统集成在一起。这意味着它可以完成基本文件系统无法完成的各种卷相关任务。它提供对数据的精细管理控制，包括管理分层存储和缓存、数据压缩和重复数据删除，以实现最大的操作系统速度和性能。

- ZFS 具有较高的读/写效率，这得益于其先进的卷管理。它会自动写入其文件系统中可用磁盘空间最多的区域。

尽管其容量和文件大小很大，但 ZFS 在整个文件系统中保持高度的数据完整性。它使用以下方法来保护数据免受损坏或磁盘故障的影响：

- 快照：ZFS 使用整个系统的频繁快照，如果发现数据损坏，将回滚到最近的快照。
- 校验和：校验和用于检测错误或损坏，必要时对早期正确数据进行修订。
- RAID-Z：一种专有形式的 RAID，可提供有针对性且高效的系统磁盘条带化。

## LVM 与 ZFS：哪个更好？你应该使用哪一个？

您对 LVM 或 ZFS 的选择取决于您的文件系统需求。

如果您有一个像 ext3 或 ext4 这样的文件系统并且需要一个卷管理器，那么 LVM 是一个理想的附加组件，因为它可以有效地与适当的文件系统一起工作。

但是，如果您还要升级文件系统，ZFS 是可用的最先进的 Linux 文件系统之一。添加卷管理器意味着您可以确信 ZFS 将管理您的数据以获得最大效率。

## LVM 与 ZFS：您应该为 Linux 使用哪种卷管理器？

**什么是卷管理器？**

卷管理器是一种在大容量存储设备上分配空间的虚拟化技术。它提供了比传统磁盘分区更大的灵活性，因为它可以以多种方式组合、集中或条带化存储的数据，使系统管理员能够实时调整数据大小或配置数据，而不会影响系统功能。

卷管理器以下列格式管理数据：

1. 物理卷——这些是硬盘或磁盘分区和外部存储设备。
2. 物理范围——构成物理卷的连续数据序列
3. 镜像物理盘区的逻辑盘区
4. 包含多个逻辑盘区的卷组

通过汇集逻辑盘区，卷管理器可以创建称为不同大小的逻辑卷的虚拟磁盘分区。卷管理器可以以多种方式使用逻辑卷，包括作为交换存储或在其上挂载文件系统。

**什么是设备映射器？**

设备映射器是 Linux 内核用于虚拟化的框架。它将各种物理块设备映射到虚拟块设备，以供包括 LVM、RAID、快照和磁盘加密在内的应用程序使用。

**什么是校验和？**

校验和是从较大的数据块中提取的相对较小的数据块，用于比较以检测可能存在的错误。基于算法的校验和函数会查找总和或采样数据值的差异，以找到可能表明错误的微小变化。卷管理器和文件系统使用校验和来保持数据完整性。

**如何向 LVM 添加新的逻辑卷？**

随着时间的推移，大多数 Linux 用户发现 LVM 很容易掌握。按照以下基本步骤在 LVM 上添加新的逻辑卷：

1. 添加您希望由 LVM 管理的任何物理存储设备，例如硬盘驱动器。
2. 从整个硬盘驱动器或仅分区创建一个新的物理卷 (PV)。
3. 您可以将新物理卷添加到现有卷组 (VG)，也可以创建新 VG。
4. 可以从新的卷组创建新的逻辑卷 (LV)。
5. 您可以使用适当的条目在您创建的 LV 上安装文件系统来挂载文件系统。

**什么是快照？**

快照只是文件系统在单个时间段内的状态。它不是数据的完整备份，但可用于将数据回滚到特定点以保持其完整性。LVM 和 ZFS 使用非常快的写时复制快照。